function init(){map=new google.maps.Map(document.getElementById("map-canvas"),{zoom:12,center:new google.maps.LatLng(51.9167,4.5),mapTypeId:google.maps.MapTypeId.ROADMAP});var e=new google.maps.Marker({position:map.center,title:name,map:map}),o=new google.maps.InfoWindow({content:"Rotterdam"});google.maps.event.addListener(e,"click",function(){o.open(map,e)})}var Pin=function(e,o,a,t){var n;this.name=ko.observable(e),this.lat=ko.observable(o),this.lon=ko.observable(a),this.text=ko.observable(t),n=new google.maps.Marker({position:new google.maps.LatLng(o,a),animation:google.maps.Animation.DROP}),this.isVisible=ko.observable(!1),this.isVisible.subscribe(function(e){n.setMap(e?map:null)}),this.isVisible(!0)},search=function(e,o){function a(){return Math.floor(1e12*Math.random()).toString()}o=[];var t="https://api.yelp.com/v2/search",n={term:e,location:"Rotterdam",radius_filter:5e3,oauth_consumer_key:"JiPu2WHv2CvMTu2KIJodFw",oauth_token:"a-iQofdMTAKu6n2T3R1i2GZ-FxbNstV3",oauth_nonce:a(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb"},r=oauthSignature.generate("GET",t,n,"w9FmW2cOcACjQqbBLn9j4f68GQI","1O1GK028G4wbFQtJz3F1FodA-5A");n.oauth_signature=r;var i={url:t,data:n,cache:!0,dataType:"jsonp",success:function(e){for(var a in e.businesses)appViewModel.resultArray.push(e.businesses[a]),console.log(o)},error:function(){}};return $.ajax(i),o}(appViewModel),appViewModel=function(){var e=this;e.searchTerm=ko.observable("Children Activities"),e.resultArray=ko.observableArray([]),e.currentSearch=function(){ko.computed(function(){return search(e.searchTerm(),e.resultArray())},e)},e.pins=ko.observableArray([]),e.filterPins=ko.computed(function(){var o=e.searchTerm().toLowerCase();return ko.utils.arrayFilter(e.pins(),function(e){var a=e.name().toLowerCase().indexOf(o)>=0;return e.isVisible(a),a})})};ko.applyBindings(new appViewModel),google.maps.event.addDomListener(window,"load",init);