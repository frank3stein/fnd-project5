function initialize(){var e={zoom:12,center:new google.maps.LatLng(-33.9,151.2)};map=new google.maps.Map(document.getElementById("map-canvas"),e),infowindow=new google.maps.InfoWindow({maxWidth:300}),createArray("Sushi","Sydney"),appViewModel.query.subscribe(appViewModel.search),ko.applyBindings(appViewModel)}var mapMarkers=[],map,infowindow,$yelpArray,Pins=function(e,a){var o=this,n=e.businesses[a];o.name=n.name,o.lat=n.location.coordinate.latitude,o["long"]=n.location.coordinate.longitude,o.info="<div id='content'><h2>"+n.name+"</h2><p>"+n.snippet_text+"</p><p>Rating:"+n.rating+"</p><img src='"+n.image_url+"'></div>",o.clicked=function(){infowindow.setContent(o.info),infowindow.open(map,t)};var t=new google.maps.Marker({position:new google.maps.LatLng(o.lat,o["long"]),title:o.name,map:map});google.maps.event.addListener(t,"click",function(){return o.clicked}())},pushModelApp=function(e){var a,o=e.businesses,n=o.length;for(a=0;n>a;a++)mapMarkers.push(new Pins(e,a));appViewModel.resultsArray(mapMarkers)},createArray=function(e,a){function o(){return Math.floor(1e12*Math.random()).toString()}var n=setTimeout(function(){alert("Yelp results failed to load. Please try again."),console.log("Ajax request failed to load")},8e3),t="https://api.yelp.com/v2/search",i={term:e,location:a,radius_filter:5e3,oauth_consumer_key:"JiPu2WHv2CvMTu2KIJodFw",oauth_token:"a-iQofdMTAKu6n2T3R1i2GZ-FxbNstV3",oauth_nonce:o(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb"},r=oauthSignature.generate("GET",t,i,"w9FmW2cOcACjQqbBLn9j4f68GQI","1O1GK028G4wbFQtJz3F1FodA-5A");i.oauth_signature=r;var s={url:t,data:i,cache:!0,dataType:"jsonp",success:function(e){pushModelApp(e),clearTimeout(n)},error:function(){}};$.ajax(s)},appViewModel={query:ko.observable(),resultsArray:ko.observableArray()};google.maps.event.addDomListener(window,"load",initialize);