function initialize(){var e={zoom:12,center:new google.maps.LatLng(-33.9,151.2)};map=new google.maps.Map(document.getElementById("map-canvas"),e),infowindow=new google.maps.InfoWindow,createArray("Sushi","Sydney"),appViewModel.resultsArray(mapMarkers),appViewModel.filteredItems=ko.computed(function(){var e=this.filter().toLowerCase();return e?this.resultsArray().filter(function(o){var a=o.name.toLowerCase().indexOf(e)>-1;return o.isVisible(a),a},appViewModel):this.resultsArray()},appViewModel),ko.applyBindings(appViewModel)}var mapMarkers=[],map,infowindow,Filtering=function(e,o,a){},Pins=function(e,o){var a=this,n=e.businesses[o];a.name=n.name,a.lat=n.location.coordinate.latitude,a["long"]=n.location.coordinate.longitude,a.info="<div id='content'><h2>"+n.name+"</h2><p>"+n.snippet_text+"</p><p>Rating:"+n.rating+"</p><img src='"+n.image_url+"'></div>",a.clicked=function(){infowindow.setContent(a.info),infowindow.open(map,t)};var t=new google.maps.Marker({position:new google.maps.LatLng(a.lat,a["long"]),title:a.name,map:map});a.isVisible=ko.observable(),a.isVisible.subscribe(function(e){t.setMap(e?map:null)}),google.maps.event.addListener(t,"click",function(){return a.clicked}())},pushModelApp=function(e){var o,a=e.businesses,n=a.length;for(o=0;n>o;o++)mapMarkers.push(new Pins(e,o))},createArray=function(e,o){function a(){return Math.floor(1e12*Math.random()).toString()}var n=setTimeout(function(){alert("Yelp results failed to load. Please try again."),console.log("Ajax request failed to load")},8e3),t="https://api.yelp.com/v2/search",i={term:e,location:o,radius_filter:5e3,oauth_consumer_key:"JiPu2WHv2CvMTu2KIJodFw",oauth_token:"a-iQofdMTAKu6n2T3R1i2GZ-FxbNstV3",oauth_nonce:a(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb"},r=oauthSignature.generate("GET",t,i,"w9FmW2cOcACjQqbBLn9j4f68GQI","1O1GK028G4wbFQtJz3F1FodA-5A");i.oauth_signature=r;var s={url:t,data:i,cache:!0,dataType:"jsonp",success:function(e){pushModelApp(e),clearTimeout(n)},error:function(){}};$.ajax(s)},appViewModel={filter:ko.observable(""),search:ko.observable(""),resultsArray:ko.observableArray([])};google.maps.event.addDomListener(window,"load",initialize);